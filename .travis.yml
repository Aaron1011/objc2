language: rust
rust:
  - stable 
  - nightly
os:
  - osx
  - linux
env:
  - FEATURES=""
  - FEATURES="exception"
matrix:
  exclude:
    - os: linux
      env: FEATURES="exception"
sudo: false
install: >
  if [ "$TRAVIS_OS_NAME" = "linux" ]; then
    export FEATURES="gnustep $FEATURES";
    ./gnustep_install.sh;
    export LIBRARY_PATH=$HOME/libobjc2_staging/lib:$LIBRARY_PATH;
    export LD_LIBRARY_PATH=$HOME/libobjc2_staging/lib:$LD_LIBRARY_PATH;
  fi
script:
  - cargo build --verbose --features "$FEATURES"
  - cargo test --verbose --features "$FEATURES"
addons:
  apt:
    packages:
      - clang-3.7
      - cmake
